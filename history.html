<!doctype html><html lang="en"><head><meta charset="utf-8"><title>Artem Sapegin’s Interactive History</title><meta name="robots" content="noindex"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="format-detection" content="telephone=no"><meta name="description" content="I’m a front-end developer, passionate photographer, coffee drinker and crazy dogs owner living in Berlin, Germany."><meta property="og:type" content="website"><meta property="og:title" content="Artem Sapegin"><meta property="og:url" content="http://sapegin.me"><meta property="og:site_name" content="Artem Sapegin"><meta property="og:description" content="I’m a front-end developer, passionate photographer, coffee drinker and crazy dogs owner living in Berlin, Germany."><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Artem Sapegin"><meta name="twitter:description" content="I’m a front-end developer, passionate photographer, coffee drinker and crazy dogs owner living in Berlin, Germany."><meta name="twitter:creator" content="@sapegin"><link href="/build/styles.css?0c947e3249d084db5430c02cffe17859" rel="stylesheet"><script>/*counters*/!function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var r={};return e.m=t,e.c=r,e.p="/build/",e(0)}([function(t,e){"use strict";!function(t,e,r){(e[r]=e[r]||[]).push(function(){try{e.yaCounter218044=new Ya.Metrika({id:218044,clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})}catch(t){}});var a=t.getElementsByTagName("script")[0],n=t.createElement("script"),c=function(){a.parentNode.insertBefore(n,a)};n.type="text/javascript",n.async=!0,n.src="https://mc.yandex.ru/metrika/watch.js","[object Opera]"==e.opera?t.addEventListener("DOMContentLoaded",c,!1):c()}(document,window,"yandex_metrika_callbacks")}]);</script></head><body class="page page_pagewithtitle"><header class="header content"><a href="/" class="link link_quoted">← <u>Home</u></a></header><div class="page-content content text"><h1 class="alpha">My History</h1><h2>Pre-computer Life</h2>
<p>I don’t remember much about my life before I met computers, but it wouldn’t be very interesting anyway. I remember my parents wanted to teach me (without success) to draw. And how I pulled a goose by its neck in a zoo but it didn’t get through the grating. But… I heard this story later on.</p>
<h2>First Computer</h2>
<p>I got my first computer from my uncle as a gift. It was Soviet clone of the legendary <a href="http://en.wikipedia.org/wiki/ZX_Spectrum">ZX Spectrum</a> in orange case. With the computer I got cassettes with games, a tape player and a book about computer internals and introduction to Basic, which was embedded in the Spectrum.</p>
<p>Every game took about five minutes to load and they were boring as all games are, so I gave up shortly and started to type some code from the book and tried to change it.</p>
<h2>QuickBasic</h2>
<p>I got my first experience in real, sane programming at Children’s Creative Center at Polyanka when I was 13. My Spectrum experience found much use there: while other pupils scratched their heads trying to draw a <a href="http://en.wikipedia.org/wiki/Flowchart">flowchart</a> I was finishing my program on the computer.</p>
<p>There weren’t enough computers for all pupils so we worked in pairs. During the year we had to make a game. I worked with my neighbour and best friend Ivan. Programming wasn’t his passion but he drew very well, and due to our common love of metal music, blood and skeletons we were an awesome team. Unfortunately we didn’t finish <a href="http://museum.sapegin.ru/gpf/group/history/ironman.html">our game</a>.</p>
<div class="embed">
					<div class="embed__content embed-ironman" style="background-image:url(/build/images/embeds/ironman/logo.png); height:201px">
						<div class="embed-ironman-i" id="ironman"></div>
					</div>
					<div class="embed__description">Use keys ← and →, mouse or thumbs and have the pleasure of Ivan’s sprites.</div>
				</div>
<h2>First Steps in Web Development</h2>
<p>I discovered <abbr>HTML</abbr> in Russian “Submarine” magazine in 1999. Using articles in the magazine and without the internet at home I made my <a href="http://museum.sapegin.ru/tsott/">first personal homepage</a>.</p>
<div class="embed">
					<div class="embed__content embed-tsott" style="background-image:url(/build/images/embeds/tsott/tsott-logo.png); height:140px">
						<div class="embed-tsott-i" id="tsott"></div>
					</div>
					<div class="embed__description">The animation on the splash page of my first homepage looked like this.</div>
				</div>
<p>It was the beginning of the biggest passion in my life that became my work a few years later. <abbr>PHP</abbr>, my own <abbr>CMS</abbr>s, a lot of free hostings, many versions of my homepage and thousands of lines of hodgie code.</p>
<p>Meanwhile I entered the Moscow State College of Information Technology where I learned touch typing and Microsoft Office. My classmate and I started there another Project of the Century (indeed unfinished) —&#8202;<a href="http://museum.sapegin.ru/lotr/">a game</a> based on “The Lord of the Rings” book.</p>
<h2>First Job</h2>
<p>Studying in the college became a work there as a computer class manager, teacher and web developer. I shared a room on a computer class’ balcony with a guy who fixed hardware and who came to work afternoon. I made the college’s new website but necessity to scold students and to look after the class distracted me from the coding.</p>
<h2>Photography</h2>
<p>For unknown reason I bought a camera after one of my first salaries. Eventually it became <a href="http://morning.photos/">my second big passion</a>.</p>
<h2>Front-end</h2>
<p>After a year of working at <abbr>SEO</abbr> oriented web design studio I suddenly changed <abbr>PHP</abbr> and back-end to JavaScript and front-end.</p>
<h2>Dogs</h2>
<p>At one point it became quite boring to code alone and now I <a href="http://instagram.com/p/XF6KXahtmS/">get a lot of help</a> from The Most Beautiful <a href="http://morning.photos/albums/dachshund/">Dessi the Dachshund</a> and since 2011 from <a href="http://morning.photos/albums/saluki/">Tsiri the Saluki</a> but she’s a beginner coder yet.</p>
<h2>Moscow ✈︎ Berlin</h2>
<p>After a half-year of Skype interviews I found a job in Berlin, Germany and we moved there with my wife and my dogs.</p></div><footer class="footer"><div class="copyrights content">© Artem Sapegin, 2002—2016</div></footer><script>/*history*/!function(t){function e(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return t[i].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="/build/",e(0)}([function(t,e,n){"use strict";function i(t,e){t.style.opacity=0;var n=+new Date,i=function o(){t.style.opacity=+t.style.opacity+(new Date-n)/e,n=+new Date,+t.style.opacity<1&&requestAnimationFrame(o)};i()}function o(t){var e=new m(["left","top"],{normal:[[x+"map.png",0]]},function(){e.action("normal")});this.draw=function(n){e.draw(n,t.camera([0,0]))}}function a(t){function e(){var t=!0,e=0,n=80;l.filter(function(i){e+=t?1:-1;var o=e*n,a=!0;if(!o)return!1;for(var s=0;s<i.length;s+=4)i[s]+i[s+1]+i[s+2]&&(i[s]+=o,i[s+1]-=o,i[s+2]-=o,t&&(255===i[s]&&i[s+1]+i[s+2]===0||(a=!1)));return a&&(t=!1),i})}this.type="player";var n=3,i=3,o=218,a=1358,s=this.pos=[360,189],r=0,l=new m(["center","bottom"],{stand:[[x+"sceleton_right.png",0]],"stand left":[[x+"sceleton_left.png",0]],"walk right":[[x+"sceleton_walk-right_1.png",n],[x+"sceleton_walk-right_2.png",n]],"walk left":[[x+"sceleton_walk-left_1.png",n],[x+"sceleton_walk-left_2.png",n]]},function(){l.action("stand")});this.draw=function(e){l.draw(e,t.camera(s))},this.updateanimation=function(){f(r,i,l)},this.update=function(){(s[0]+r<o||s[0]+r>a)&&(r=0),s[0]+=r,this.updateanimation(),l.update()},this.get_collision_aabb=function(){return l.aabb(s)},this.collide_aabb=function(t){"spider"===t.type&&e()},this.keyDown_37=function(){this.updateanimation(),r=-i},this.keyDown_39=function(){this.updateanimation(),r=i},this.keyUp_37=this.keyUp_39=function(){this.updateanimation(),r=0}}function s(t){this.type="enemy";var e=6,n=1,i=1430,o=1550,a=this.pos=[1440,189],s=n,r=new m(["center","bottom"],{stand:[[x+"enemy_right.png",0]],"stand left":[[x+"enemy_left.png",0]],"walk right":[[x+"enemy_walk-right_1.png",e],[x+"enemy_walk-right_2.png",e]],"walk left":[[x+"enemy_walk-left_1.png",e],[x+"enemy_walk-left_2.png",e]]},function(){r.action("walk right")});this.draw=function(e){r.draw(e,t.camera(a))},this.updateanimation=function(){f(s,n,r)},this.update=function(){(a[0]+s<i||a[0]+s>o)&&(s=-s),a[0]+=s,this.updateanimation(),r.update()}}function r(t,e){this.type="spider";var n=e[1],i=150,o=8,a="#aaa",s=1;e[1]=C.nextInt(n,i);var r=new m(["center","top"],{normal:[[x+"spider.png",0]]},function(){r.action("normal")});this.draw=function(i){i.save(),i.fillStyle=a;var s=e[0]-t.cameraX;i.fillRect(s,n,1,e[1]+o-n),r.draw(i,t.camera([e[0]+1,e[1]])),i.restore()},this.update=function(){(e[1]+s<n||e[1]+s>i)&&(s=-s),e[1]+=s,r.update()},this.get_collision_aabb=function(){return r.aabb(e)}}function l(t,e){this.type="drop";var n=e.minY,i=190,o=.75,a=[e.x,n],s=!1;this.draw=function(n){n.save(),n.fillStyle=e.color,n.fillRect(a[0]-t.cameraX,a[1],1,1),n.restore()},this.update=function(){a[1]+o>i?(a[1]=n,isNaN(e.minPause)||isNaN(e.maxPause)||(s=!0,setTimeout(function(){s=!1},C.nextInt(e.minPause,e.maxPause)))):s||(a[1]+=o)}}function h(){var t=this;this.cameraX=260;var e=100,n=3,i=new a(this),h=[];this.camera=function(t){return[t[0]-this.cameraX,t[1]]},this.init=function(){function e(){I.addEntity(new l(t,{x:157,minY:16,color:"#a00",minPause:0,maxPause:1e3}))}I.addEntity(new o(t)),I.addEntity(new l(t,{x:486,minY:50,color:"#5656fd",minPause:200,maxPause:2e3}));for(var n=1;b>=n;n++)setTimeout(e,C.nextInt(1e3*n,1e3*n+1e3));I.addEntity(i),I.addEntity(new s(t));for(var a=0;a<E.length;a++){var c=new r(t,E[a]);I.addEntity(c),h.push(c)}},this.draw=function(){I.background(k)},this.update=function(){v.aabb([i],h);var t=i.pos[0]-this.cameraX;t>I.width-e?this.cameraX+=n:e>t&&(this.cameraX-=n),I.width+this.cameraX>w-e&&(this.cameraX=w-e-I.width)},this.pointerDown=function(){I.pointerPosition[0]<i.pos[0]-this.cameraX?i.keyDown_37():i.keyDown_39()},this.pointerUp=function(){i.keyUp_37()},this.pointerBox=function(){return[0,0,I.width,I.height]}}function c(){var t=document.getElementById("ironman"),e=document.createElement("canvas");return u(t,e),t.appendChild(e),window.addEventListener("resize",function(){u(t,e)}),e}function u(t,e){p=t.offsetWidth,e.style.width=e.width=p,e.style.height=e.height=_,I&&(I.width=p)}function d(){var t=new g;return t.seed((new Date).getTime()),t}function f(t,e,n){if(t>=e)n.action("walk right");else if(-e>=t)n.action("walk left");else{var i=n.get_action();"walk right"===i?n.action("stand"):"walk left"===i&&n.action("stand left")}}var p,g=n(1),m=n(2),v=n(3),y=n(4),w=1600,_=201,x="/build/images/embeds/ironman/",E=[[522,77],[649,60],[869,62],[1048,60]],b=3,k="#000",C=d(),P=c(),I=new y(P,30);m.preload([x+"map.png",x+"sceleton_right.png",x+"sceleton_left.png",x+"sceleton_walk-right_1.png",x+"sceleton_walk-right_2.png",x+"sceleton_walk-left_1.png",x+"sceleton_walk-left_2.png",x+"enemy_right.png",x+"enemy_left.png",x+"enemy_walk-right_1.png",x+"enemy_walk-right_2.png",x+"enemy_walk-left_1.png",x+"enemy_walk-left_2.png",x+"spider.png"],function(){I.addEntity(new h),i(P,1200)}),I&&I.launch()},function(t,e){function n(t){this.last_seed=null,this.next=function(){return 0==this.x&&-1==this.x,0==this.y&&-1==this.y,this.x=this.nextX(),this.y=this.nextY(),((this.x<<16)+(65535&this.y))/4294967295+.5},this.random=this.next,this.nextX=function(){return 36969*(65535&this.x)+(this.x>>16)},this.nextY=function(){return 18273*(65535&this.y)+(this.y>>16)},this.nextInt=function(t,e){return e||(t=0,e=4294967295),Math.floor(this.next()*(e-t))+t},this.seed=function(t){this.last_seed=t,this.x=3253*t,this.y=this.nextX()},this.seed2d=function(t,e){this.last_seed=[t,e],this.x=2549*t+3571*e,this.y=2549*e+3571*t},this.seed3d=function(t,e,n){this.last_seed=[t,e,n],this.x=2549*t+3571*e+3253*n,this.y=3253*t+2549*e+3571*n},this.seed(null==t?(new Date).getTime():t)}t.exports=n},function(t,e){function n(t,e,n){var i=0,o="",a=-1,s=0,r=this,l=0,h=null;this.loaded=!1,this.width=0,this.height=0,this.filtered=!1;for(var c in e){for(var u=0;u<e[c].length;u++)if("string"==typeof e[c][u][0]){i+=1;var d=new Image;d.src=e[c][u][0],e[c][u][0]=d,d.onload=function(){i-=1,0==i&&(r.width=parseInt(d.width),r.height=parseInt(d.height),r.loaded=!0,n&&n())}}0==i&&(e[c].length&&e[c][0].length&&(r.width=e[c][0][0].width,r.height=e[c][0][0].height),r.loaded=!0,n&&n())}var f={left:function(t){return 0},right:function(t){return t.width},center:function(t){return t.width/2}},p={top:function(t){return 0},bottom:function(t){return t.height},center:function(t){return t.height/2}};this.action=function(t,n,i){return h="undefined"==typeof i?null:i,o=t,l=e[t].length,n?(a=e[t][0][1],s=0):s%=e[t].length,r.update=r._update,r.draw=r._draw,r.aabb=r._aabb,this},this.get_action=function(){return o},this.get_frame=function(){return s},this.get_num_frames=function(){return l},this.set_frame=function(t){s=t},this.filter=function(t){this.filtered||(this.filtered=!0,this.filterFunc=t,this.filterFrame=1)},this._update=function(){if(a-=1,0>=a){h&&s+1>=e[o].length&&h(o),s=(s+1)%e[o].length;var t=e[o][s];a=t[1],this.width=t[0].width,this.height=t[0].height}this.filtered&&(this._filterSprite(),this.filterFrame++)},this._draw=function(n,i){var a=e[o][s][0],r=i[0]-f[t[0]](a),l=i[1]-p[t[1]](a);if(this.filtered)try{n.putImageData(this.filteredImageData,r,l)}catch(h){}else n.drawImage(a,r,l)},this._aabb=function(n){var i=e[o][s][0];return[n[0]-f[t[0]](i),n[1]-p[t[1]](i),i.width,i.height]},this._filterSprite=function(){var t=this.width,n=this.height,i=document.createElement("canvas");i.width=t,i.height=n;var a=i.getContext("2d");a.fillStyle="#000",a.fillRect(0,0,t,n),a.drawImage(e[o][s][0],0,0);var r=a.getImageData(0,0,t,n),l=this.filterFunc(r.data,this.filterFrame);l?(r.data=l,this.filteredImageData=r):this.filtered=!1},this.update=function(){},this.draw=function(){},this.aabb=function(){return[0,0,0,0]}}n.preload=function(t,e,n){for(var i=t.length,o=[],a=0;a<t.length;a++)o[a]=new Image,o[a].onload=function(){i-=1,n&&n(i),0==i&&e&&e()},o[a].src=t[a]},t.exports=n},function(t,e){collide={},collide.collideall=function(t,e){var n="collide_"+e;return function(e,i){for(var o in e)for(var a in i){var s=e[o],r=i[a];if(s!=r&&e.hasOwnProperty(o)&&i.hasOwnProperty(a)){var l=t(s,r);l&&(s[n]&&s[n](r,l),r[n]&&r[n](s,l))}}}},collide.aabb=function(){},collide.collide_aabb_entities=function(t,e){if(e.get_collision_aabb&&t.get_collision_aabb){var n=t.get_collision_aabb(),i=e.get_collision_aabb();return!(n[0]>i[0]+i[2]||i[0]>n[0]+n[2]||n[1]>i[1]+i[3]||i[1]>n[1]+n[3])}},collide.aabb=collide.collideall(collide.collide_aabb_entities,"aabb"),collide.circles=function(){},collide.collide_circle_entities=function(t,e){if(e.get_collision_circle&&t.get_collision_circle){var n=t.get_collision_circle(),i=e.get_collision_circle();return Math.pow(n[0][0]-i[0][0],2)+Math.pow(n[0][1]-i[0][1],2)<Math.pow(n[1]+i[1],2)}},collide.circles=collide.collideall(collide.collide_circle_entities,"circle");var n=function(t,e){cn=0,pts=e.slice(),pts.push([e[0][0],e[0][1]]);for(var n=0;n<e.length;n++)(pts[n][1]<=t[1]&&pts[n+1][1]>t[1]||pts[n][1]>t[1]&&pts[n+1][1]<=t[1])&&t[0]<pts[n][0]+(t[1]-pts[n][1])/(pts[n+1][1]-pts[n][1])*(pts[n+1][0]-pts[n][0])&&(cn+=1);return cn%2},i=function(t,e){var n=t[0],i=t[1],o=e[0],a=e[1],s=n[0],r=n[1],l=i[0],h=i[1],c=o[0],u=o[1],d=a[0],f=a[1],p=(d-c)*(r-u)-(f-u)*(s-c),g=(l-s)*(r-u)-(h-r)*(s-c),m=(f-u)*(l-s)-(d-c)*(h-r);if(m){var v=p/m,y=g/m;return v>=0&&1>=v&&y>=0&&1>=y?[s+v*(l-s),r+v*(h-r)]:[]}return 0==p||0==g?[(l+s)/2,(h+r)/2]:[]};collide.polys=function(){},collide.collide_poly_entities=function(t,e){if(e.get_collision_poly&&t.get_collision_poly){for(var o=t.get_collision_poly(),a=e.get_collision_poly(),s=0;s<o.length;s++)for(var r=0;r<a.length;r++){var l=[o[s],o[(s+1)%o.length]],h=[a[r],a[(r+1)%a.length]],c=i(l,h);if(c.length)return[l,h,c]}return n(o[0],a)||n(a[0],o)}},collide.polys=collide.collideall(collide.collide_poly_entities,"poly"),t.exports=collide},function(t,e){function n(t,e){if(this.frameCount=0,this.framerate=e,this.pointerPosition=[0,0],this.pointerDown=!1,"string"==typeof t&&(t=document.getElementById(t)),"canvas"==t.tagName.toLowerCase())this.canvas=t;else{var n=t;t=document.createElement("canvas"),t.style.width=t.width=n.offsetWidth+1,t.style.height=t.height=n.offsetHeight+1,n.innerHTML="",n.appendChild(t),this.canvas=t}if("undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(t),this.canvas.style.cursor="default",!this.canvas||!this.canvas.getContext)return alert("You are on a platform that does not support Canvas.\nTry ExplorerCanvas or FlashCanvas, maybe?"),this.width=0,this.height=0,this.random=this.nullfunc,this.addEntity=this.nullfunc,void(this.launch=this.nullfunc);this.ctx=this.canvas.getContext("2d");var i=this;this.width=parseInt(this.canvas.width),this.height=parseInt(this.canvas.height),this.include=function(t,e){var e=e,n=document.getElementsByTagName("head")[0];script=document.createElement("script"),script.type="text/javascript",script.src=t,e&&(script.onload=function(){e(t)}),n.appendChild(script)},this.schedule=function(t,e){if(t>0){var n=this.frameCount+t;n in o||(o[n]=[]),o[n].push(e)}};var o={};this.nullfunc=function(){},this.clear=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)},this.polygon=function(t,e){this.ctx.save(),this.ctx.beginPath(),this.ctx.moveTo(t[0][0],t[0][1]);for(var n=0;n<t.length;n++)this.ctx.lineTo(t[n][0],t[n][1]);e&&this.ctx.lineTo(t[0][0],t[0][1]),this.ctx.closePath(),this.ctx.fill(),this.ctx.stroke(),this.ctx.restore()},this.background=function(t){this.ctx.save(),this.ctx.fillStyle=t,this.ctx.fillRect(0,0,this.width,this.height),this.ctx.restore()},this.random=function(t,e){return Math.random()*(e-t)+t},this.distance=function(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},this.heldKeys={},this.attachEvent=function(t){var e=this.canvas;0==t.indexOf("key")&&(e=document),e.addEventListener?e.addEventListener(t,this["on"+t],!1):e.attachEvent?e.attachEvent("on"+t,this["on"+t]):e["on"+t]=this["on"+t]},this.oncontextmenu=function(t){return i.cancelEvent(t),!1},this.attachEvent("contextmenu"),this.cancelEvent=function(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0},this.isTouchDevice=function(){try{return document.createEvent("TouchEvent"),!0}catch(t){return!1}},this.getSetPointerPosition=function(e){var n,i;if(e.touches){var o=e.touches[0]||e.changedTouches[0];n=o.pageX-t.offsetLeft,i=o.pageY-t.offsetTop}else n=e.pageX-t.offsetLeft,i=e.pageY-t.offsetTop;return this.pointerPosition=[n,i],this.pointerPosition},this.ontouchstart=function(t){var t=t?t:window.event;return i.pointInEntitiesCall(i.getSetPointerPosition(t),"pointerDown",t.touches.length),i.cancelEvent(t),i.pointerDown=!0,!1},this.attachEvent("touchstart"),this.ontouchend=function(t){var t=t?t:window.event;return i.pointInEntitiesCall(i.getSetPointerPosition(t),"pointerUp",t.touches.length),i.cancelEvent(t),i.pointerDown=!1,!1},this.attachEvent("touchend"),this.onmove=function(t,e){var t=t?t:window.event;return i.pointInEntitiesCall(i.getSetPointerPosition(t),"pointerMove",e),i.cancelEvent(t),!1},this.ontouchmove=function(t){i.onmove(t,t.touches.length)},this.attachEvent("touchmove"),this.onmousedown=function(t){var t=t?t:window.event;return i.pointInEntitiesCall(i.getSetPointerPosition(t),"pointerDown",t.button),i.cancelEvent(t),i.pointerDown=!0,!1},this.attachEvent("mousedown"),this.onmouseup=function(t){var t=t?t:window.event;return i.pointInEntitiesCall(i.getSetPointerPosition(t),"pointerUp",t.button),i.cancelEvent(t),i.pointerDown=!1,!1},this.attachEvent("mouseup"),this.onmousemove=function(t){i.onmove(t,t.button)},this.attachEvent("mousemove"),this.onkeydown=function(t){var t=t?t:window.event;i.heldKeys[t.keyCode]||(i.entitiesCall("keyDown",t.keyCode),i.entitiesCall("keyDown_"+t.keyCode),i.heldKeys[t.keyCode]=!0)},this.attachEvent("keydown"),this.onkeyup=function(t){var t=t?t:window.event;i.heldKeys[t.keyCode]&&(i.entitiesCall("keyUp",t.keyCode),i.entitiesCall("keyUp_"+t.keyCode),i.heldKeys[t.keyCode]=!1)},this.attachEvent("keyup");var a=[],s=[],r=[],l=0,h=[],c=[],u=[],d=[];this.addEntity=function(t){return s.push(t),t},this.delEntity=function(t){return r.push(t),t},this.inEntities=function(t){return a.indexOf(t)>=0},this.clearEntities=function(){for(var t=0;t<a.length;t++)r.push(a[t]);return a.length>0},this.getTriggeredEntities=function(){return c},this.addEntityToSpecialistLists=function(t){for(var e in t)0==e.indexOf("keyHeld")&&u.indexOf(t)<0&&u.push(t),0==e.indexOf("collision")&&d.indexOf(t)<0&&d.push(t)},this.removeEntityFromSpecialistLists=function(t){u.remove(t),d.remove(t)},this.gameSoupLoop=function(){if(this.frameCount in o){for(var t=0;t<o[this.frameCount].length;t++)o[this.frameCount][t](this);delete o[this.frameCount]}for(var e=0;e<a.length;e++)a[e].update&&a[e].update(this);var n=null;for(c=[];n=h.shift();)n[0][n[1]](n[2])&&c.push(n[0]);for(var e=0;e<s.length;e++)s[e].priority||(s[e].priority=0),s[e].priority_preference=l,l+=1,a.push(s[e]),this.addEntityToSpecialistLists(s[e]),s[e].init&&s[e].init(this),s[e].update&&s[e].update(this);s.length&&this.sortEntities(),s=[];for(var e=0;e<r.length;e++)a.remove(r[e]),this.removeEntityFromSpecialistLists(r[e]);r=[];for(var e=0;e<u.length;e++){var i=!1;for(var d in this.heldKeys)this.heldKeys[d]&&(this.callAll(u,"keyHeld_"+d),i=!0);i&&this.callAll(u,"keyHeld")}this.clear();for(var e=0;e<a.length;e++)a[e].draw&&(this.ctx.save(),a[e].draw(this.ctx,this),this.ctx.restore());this.frameCount+=1},this.launch=function(){var t=this;setInterval(function(){t.gameSoupLoop()},1e3/this.framerate)},this.sortEntities=function(){a.sort(function(t,e){return t.priority==e.priority?t.priority_preference-e.priority_preference:t.priority-e.priority})},this.pointInPoly=function(t,e){cn=0,pts=e.slice(),pts.push([e[0][0],e[0][1]]);for(var n=0;n<e.length;n++)(pts[n][1]<=t[1]&&pts[n+1][1]>t[1]||pts[n][1]>t[1]&&pts[n+1][1]<=t[1])&&t[0]<pts[n][0]+(t[1]-pts[n][1])/(pts[n+1][1]-pts[n][1])*(pts[n+1][0]-pts[n][0])&&(cn+=1);return cn%2},this.pointInBox=function(t,e){return t[0]>=e[0]&&t[0]<=e[2]&&t[1]>=e[1]&&t[1]<=e[3]},this.pointInCircle=function(t,e){return this.distance(t,e.slice(0,2))<=e[2]},this.pointInEntitiesCall=function(t,e,n){for(var i=[],o=0;o<a.length;o++){var s=a[o];s[e]&&(s.pointerPoly&&this.pointInPoly(t,s.pointerPoly())||s.pointerBox&&this.pointInBox(t,s.pointerBox())||s.pointerCircle&&this.pointInCircle(t,s.pointerCircle())||s.pointerTest&&s.pointerTest(t))&&(h.push([s,e,n]),i.push(s))}return i},this.entitiesCall=function(t,e){this.callAll(a,t,e)},this.callAll=function(t,e,n){for(var i=0;i<t.length;i++)t[i][e]&&h.push([t[i],e,n])}}function i(){for(var t=document.getElementsByTagName("canvas"),e=0;e<t.length;e++){var i=null,o=15;if(t[e].getAttribute?(t[e].getAttribute("jsgs")&&(i=t[e].getAttribute("jsgs")),t[e].getAttribute("fps")&&(o=t[e].getAttribute("fps"))):(t[e].jsgs&&(i=t[e].jsgs),t[e].fps&&(o=t[e].fps)),i){var a=new n(t[e],o);this[i](a),a.launch()}}}function o(){var t=document.createElement("div");document.body.appendChild(t),t.style.position="absolute",t.style.width="100%",t.style.height="100%";var e=function(){0==parseInt(t.offsetWidth)?setTimeout(e,13):(document.body.removeChild(t),delete t,n.ready_function&&n.ready_function(),i())};e()}function a(){arguments.callee.done||(arguments.callee.done=!0,o())}function s(){var t=document;return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}if(n.ready=function(t){n.ready_function=t},document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),a()},!1):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",arguments.callee),a())}),document.documentElement.doScroll&&window==window.top&&function(){if(!a.done){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(arguments.callee,0)}a()}}()),_prevOnload=window.onload,window.onload=function(){"function"==typeof _prevOnload&&_prevOnload(),a()},Array.prototype.each||(Array.prototype.each=function(t){var e=[];this.fn=t;for(var n=0;n<this.length;n++)e[n]=this.fn(this[n],n);return e}),Number.prototype.mod=function(t){return(this%t+t)%t},Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,n=Number(arguments[1])||0;for(n=0>n?Math.ceil(n):Math.floor(n),0>n&&(n+=e);e>n;n++)if(n in this&&this[n]===t)return n;return-1}),Array.prototype.remove||(Array.prototype.remove=function(t){var e=this.indexOf(t);e>=0&&this.splice(e,1)}),"undefined"==typeof console){var r=document.getElementsByTagName("body");if(r.length){var l=document.createElement("pre");l.style.width="100%",l.style.position="absolute",l.style.top=s()-100+"px",l.style.height="50px",l.style.left="0px",l.style.filter="alpha(opacity=50)",l.style.opacity="0.5",l.style.margin="0",l.style.padding="0",l.style.overflow="hidden",l.style.textAlign="left",l.style.borderTop="1px solid black",l.style.display="none",r[0].appendChild(l),window.console={log:function(t){l.style.display="block",l.innerHTML+=t+"\r\n"}}}else window.console={log:function(t){}}}t.exports=n}]);</script></body></html>